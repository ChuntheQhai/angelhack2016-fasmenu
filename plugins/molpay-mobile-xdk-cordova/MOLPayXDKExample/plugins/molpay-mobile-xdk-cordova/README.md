<!--
# license: Copyright Â© 2011-2016 MOLPay Sdn Bhd. All Rights Reserved. 
-->

# molpay-mobile-xdk-cordova

This is the complete and functional MOLPay Cordova payment module that is ready to be implemented into Cordova project through Cordova plugin installation procedures. An example application project (MOLPayXDKExample) is provided for MOLPayXDK Cordova integration reference.

This plugin provides an integrated MOLPay payment module that contains a wrapper 'molpay.js' and an upgradable core as the 'molpay-mobile-xdk-www' folder, which the latter can be separately downloaded at https://github.com/MOLPay/molpay-mobile-xdk-www and update the local version.

## Recommended configurations

    - Cordova SDK Version: 6.1.0 ++
    
    - Node.js Version: 5.3.0 ++
    
    - Minimum Android target version: Android 4.1
    
    - Minimum iOS target version: 7.0

## MOLPay Android Caveats

    Credit card payment channel is not available in Android 4.1, 4.2, and 4.3. due to lack of latest security (TLS 1.2) support on these Android platforms natively.

## Installation

    Step 1 - cordova plugin add molpay-mobile-xdk-cordova
    
    Step 2 - Add the following meta tags to the app index.html
    <meta http-equiv="Content-Security-Policy" content="default-src * data: gap: 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *"> *This allow cross-domain communication between MOLPay payment module and payment servers.*
    <meta name="format-detection" content="telephone=no">
    
    Step 3 - Add the MOLPay div to your payment UI
    <div id="molpay" class="molpay"/>
    
    Step 4 - Add the result callback function
    var molpayCallback = function (transactionResult) {
            // transactionResult return in json;
    };
    
    =========================================
    Sample transaction result in JSON string:
    =========================================
    
    {"status_code":"11","amount":"1.01","chksum":"34a9ec11a5b79f31a15176ffbcac76cd","pInstruction":0,"msgType":"C6","paydate":1459240430,"order_id":"3q3rux7dj","err_desc":"","channel":"Credit","app_code":"439187","txn_ID":"6936766"}
    
    Parameter and meaning:
    
    "status_code" - "00" for Success, "11" for Failed, "22" for *Pending. 
    (*Pending status only applicable to cash channels only)
    "amount" - The transaction amount
    "paydate" - The transaction date
    "order_id" - The transaction order id
    "channel" - The transaction channel description
    "txn_ID" - The transaction id generated by MOLPay
    
    * Notes: You may ignore other parameters and values not stated above
    
    =====================================
    * Sample error result in JSON string:
    =====================================
    
    {"Error":"Communication Error"}
    
    Parameter and meaning:
    
    "Communication Error" - Error starting a payment process due to several possible reasons, please contact MOLPay support should the error persists.
    1) Internet not available
    2) API credentials (username, password, merchant id, verify key)
    3) MOLPay server offline.

## Prepare the Payment detail object

    document.addEventListener("deviceready", onDeviceReady, false);
    function onDeviceReady() {
        var paymentDetails = {
            'mp_amount' : '',
            'mp_username' : '',
            'mp_password' : '',
            'mp_merchant_ID' : '',
            'mp_app_name' : '',   
            'mp_order_ID' : '', 
            'mp_currency' : 'MYR',
            'mp_country' : 'MY',  
            'mp_verification_key' : '',  
            'mp_channel' : '', 
            'mp_bill_description' : '',
            'mp_bill_name' : '',
            'mp_bill_email' : '',
            'mp_bill_mobile' : '',
            'mp_channel_editing' : false,
            'mp_editing_enabled' : false,
            'mp_transaction_id' : '',
            'mp_request_type' : ''
            //'mp_is_escrow' : '' // Optional for Escrow, put "1" to enable escrow
        };
    }

## Start the payment module UI

    window.molpay.startMolpay(paymentDetails, molpayCallback);

## Close the payment module UI

    window.molpay.closeMolpay();
    
    * Notes: closeMolpay does not close remove the UI, the host application must implement it's own mechanism to close the payment module UI, i.e. <button onclick="window.molpay.closeMolpay()">Close</button>. The close event will also return a final result.

## Transaction status request service (No UI & auto close) (optional)

    window.molpay.transactionRequest(paymentDetails, molpayCallback);

## Support

Submit issue to this repository or email to our support@molpay.com

Merchant Technical Support / Customer Care : support@molpay.com<br>
Sales/Reseller Enquiry : sales@molpay.com<br>
Marketing Campaign : marketing@molpay.com<br>
Channel/Partner Enquiry : channel@molpay.com<br>
Media Contact : media@molpay.com<br>
R&D and Tech-related Suggestion : technical@molpay.com<br>
Abuse Reporting : abuse@molpay.com
